vivaxGEN Installation Script Collection
=======================================

Quick Start
-----------

For vivaxGEN `ngs-pipeline <https://github.com/vivaxgen/ngs-pipeline>`_,
install with the following command::

    "${SHELL}" <(curl -L https://raw.githubusercontent.com/vivaxgen/install/main/ngs-pl.sh)

For `SRA Repo <https://github.com/vivaxgen/sra-repo>`_, install with the
following command::

    "${SHELL}" <(curl -L https://raw.githubusercontent.com/vivaxgen/install/main/sra-repo.sh)

For G6PD amplicon sequencing pipeline, install with the following command::

    "${SHELL}" <(curl -L https://raw.githubusercontent.com/vivaxgen/install/main/G6PD-pl.sh)

For vivaxGEN `MicroHaps sequencing pipeline <https://github.com/vivaxgen/MicroHaps>`_,
install with the following command::

    "${SHELL}" <(curl -L https://raw.githubusercontent.com/vivaxgen/install/main/MicroHaps-pl.sh)


Quick Overview
--------------

This repo contains install scripts for software packages (such as various
pipelines) that use micromamba to provide all binary dependencies.

The following is base structure of the directories generated by base.sh,
assuming that VVG_BASEDIR is the base directory of the installation::

    VVG_BASEDIR/
                bin/
                    activate.sh
                    micromamba
                opt/
                    umamba/
                envs/
                etc/
                    bashrc.d/
                    snakemake-profiles/

``bin/activate.sh``
  The activation script which needed to be source first before using the
  installed software package, will perform the following:

  - export ``$VVG_BASEDIR`` environment variable with the VVG_BASEDIR

  - add ``$VVG_BASEDIR/bin/`` to PATH

  - set ``$MAMBA_ROOT_PREFIX`` to ``$VVG_BASEDIR/opt/umamba``

  - prepare and activate the required micromamba environment

  - source any bashrc file in ``$VVG_BASEDIR/etc/bashrc.d/`` in alphabetical order

``bin/micromamba``
  The micromamba executable binary.

``opt/umamba/``
  The directory to hold micromamba environments and packages.

``envs/``
  The directory to hold the pipeline environments and/or the software packages.

``etc/bashrc.d/``
  Directory containing bash resource files to be sourced in alphabetical order
  when ``bin/activate.sh`` is being sourced.
  Software package's specific activation source file should be put inside this
  directory.

  The activation source file name should be prefixed with 2-digit and dash, eg
  for vivaxGEN NGS-Pipeline, the source file is ``10-ngs-pipeline``.
  Other pipelines and software packages that rely on vivaxGEN NGS-Pipeline
  should use number starting from ``50-``.
  Other global settings that can be modified by users should use number
  starting from ``90-``, eg. the snakemake job scheduler profile setting is
  ``99-snakemake-profiles``.

``etc/snakemake-profiles/``
  The directory for holding the snakemake profiles related to job scheduler,
  eg. profiles related to slurm.

